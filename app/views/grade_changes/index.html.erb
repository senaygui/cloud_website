<div class="container mt-4">
  <div class="card">
    <div class="card-header bg-primary text-white">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h3 class="mb-0">Grade Change Requests</h3>
        </div>
        <div class="col-md-4 text-right">
          <%= link_to 'New Request', new_grade_change_path(grade_id: params[:grade_id]), class: 'btn btn-danger text-white' %>
        </div>
      </div>
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead class="thead-light">
            <tr>
              <th>Course</th>
              <th>Previous Grade</th>
              <th>Current Total Assessment</th>
              <th>Current Grade</th>
              <th>Status</th>
              <th>Created At</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% @grade_changes.each do |grade_change| %>
              <tr>
                <td><%= grade_change.course.course_title %></td>
                <td>
                  <%= grade_change.previous_result_total %> 
                  (<%= grade_change.previous_letter_grade %>)
                </td>
                <td><%= grade_change.add_mark %></td>
                <td>
                  <% if grade_change.current_result_total.present? %>
                    <%= grade_change.current_result_total %> 
                    (<%= grade_change.current_letter_grade %>)
                  <% else %>
                    -
                  <% end %>
                </td>
                <td>
                  <% if grade_change.instructor_approval == 'approved' && 
                        grade_change.department_approval == 'approved' && 
                        grade_change.dean_approval == 'approved' && 
                        grade_change.registrar_approval == 'approved' %>
                    <span class="badge bg-success">Approved</span>
                  <% elsif grade_change.instructor_approval == 'denied' || 
                          grade_change.department_approval == 'denied' || 
                          grade_change.dean_approval == 'denied' || 
                          grade_change.registrar_approval == 'denied' %>
                    <span class="badge bg-danger">Rejected</span>
                  <% else %>
                    <span class="badge bg-warning">Pending</span>
                  <% end %>
                </td>
                <td><%= grade_change.created_at.strftime("%B %d, %Y") %></td>
                <td>
                  <%= link_to 'View', grade_change_path(grade_change), class: 'btn btn-sm btn-info' %>
                  <% if grade_change.instructor_approval == 'pending' %>
                    <%= link_to 'Edit', edit_grade_change_path(grade_change), class: 'btn btn-sm btn-primary' %>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<style>
  .card {
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    border: none;
    border-radius: 0.5rem;
  }
  
  .card-header {
    border-radius: 0.5rem 0.5rem 0 0 !important;
  }
  
  .table {
    margin-bottom: 0;
  }
  
  .table thead th {
    background-color: #f8f9fa;
    border-bottom: 2px solid #dee2e6;
  }
  
  .badge {
    font-size: 0.875rem;
    padding: 0.35em 0.65em;
  }
  
  .btn-sm {
    padding: 0.25rem 0.5rem;
    font-size: 0.875rem;
  }
</style> 