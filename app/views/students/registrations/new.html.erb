<%provide(:title, "Sign Up")%>
<style type="text/css">
  * {box-sizing: border-box;}
  .tab{display: none; width: 100%; height: 100%;margin: 0px auto;}
  .current{display: block;}

  body {background-color: #f1f1f1;}

  /*form {background-color: #ffffff; margin: 100px auto; font-family: Raleway; padding: 40px;  }*/

  h1 {text-align: center; }

  /*input {padding: 10px; width: 100%; font-size: 17px; font-family: Raleway; border: 1px solid #aaaaaa; }*/

  button {background-color: #4CAF50; color: #ffffff; border: none; padding: 10px 20px; font-size: 17px; font-family: Raleway; cursor: pointer; }

  button:hover {opacity: 0.8; }

  .previous {background-color: #bbbbbb; }

  /* Make circles that indicate the steps of the form: */
  .step {height: 30px; width: 30px; cursor: pointer; margin: 0 2px; color: #fff; background-color: #bbbbbb; border: none; border-radius: 50%; display: inline-block; opacity: 0.8; padding: 5px}

  .step.active {opacity: 1; background-color: #69c769;}

  .step.finish {background-color: #4CAF50; }

  .error{
    color: #f00;
    display: block !important;
    width: 100%;
  }
  .fix{
    background: #f6f8fa !important;
    position: fixed;
    width: 100%;
    bottom: 0;
    z-index: 1;
  }
  /* Initially hide the submit button */

  .submit:disabled {
  background-color: #cccccc;
  cursor: not-allowed;
}


</style>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/icheck-bootstrap/3.0.1/icheck-bootstrap.min.css" integrity="sha512-8vq2g5nHE062j3xor4XxPeZiPjmRDh6wlufQlfC6pdQ/9urJkU07NM0tEREeymP++NczacJ/Q59ul+/K2eYvcg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<div class="content-wrapper mt-3" style="min-height: 1477.62px;">
  <div class="content">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12">
          <div class="card card card-primary">
            <div class="card-header">
              <h3 class="card-title">
                <i class="fas fa-edit"></i>
                New Student Admission Forms
              </h3>
            </div>
            <%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name),wrapper: :input_group, multiple: true) do |f| %>
              <div class="card-body p-0">
                <div class="">
                  <div class="content m-3">
                    <!-- your steps content here -->
                    <div class="tab">
                      <div class="row">
                        <div class="col-12 col-md-3">
                          <div class="row">
                            <div class="col-12">
                              <%= render "students/shared/error_messages", resource: resource %>
                            </div>
                            <div class="col-12">
                              <div class="card  card-primary">
                                <div class="card-header">
                                  <h3 class="card-title">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    <strong>Instruction</strong>
                                  </h3>
                                </div>
                                <!-- /.card-header -->
                                <div class="card-body">
                                  <p  class="text-center"><strong>Fill in the space(s) or Select the appropriate box(es) or selctions. * fields are required.</strong></p>
                                  <p class="text-muted text-center">
                                    You must provide your address information on the fields provided. Once you fill all the required feilds hit the Continue button.
                                  </p>
                                  <hr>
                                </div>
                                <!-- /.card-body -->
                              </div>
                              <div class="card  card-primary">
                                <div class="card-header">
                                  <h3 class="card-title">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    <strong>Photo Instruction</strong>
                                  </h3>
                                </div>
                                <!-- /.card-header -->
                                <div class="card-body">
                                  <p  class="text-center"><strong>We recommend you use a professional visa photo service to ensure your photo meets all the requirements.</strong></p>
                                  <p class="text-muted text-center">
                                    <ol class="text-muted">
                                      <li>Taken within the last 6 months to reflect your current appearance</li>
                                      <li>Taken in front of a plain white or off-white background</li>
                                      <li>With a neutral facial expression and both eyes open</li>
                                      <li>Taken in clothing that you normally wear on a daily basis</li>
                                      <li>Do not wear a hat or head covering that obscures the hair or hairline, unless worn daily for a religious purpose. Your full face must be visible, and the head covering must not cast any shadows on your face.Headphones, wireless hands-free devices, or similar items are not acceptable in your photo.</li>
                                    </ol>
                                  </p>
                                  <hr>
                                </div>
                                <!-- /.card-body -->
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-12 col-md-9">
                          <div class="card card-outline card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Basic Information</strong>
                              </h3>
                            </div>
                            <div class="card-body">
                              <%= render 'basic', f: f %>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div id="admission" class="content tab">
                      <div class="row">
                        <div class="col-12 col-md-3">
                          <div class="card card-outline card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Instruction</strong>
                              </h3>
                            </div>
                            <!-- /.card-header -->
                            <div class="card-body">
                              <p  class="text-center"><strong>Fill in the space(s) or Select the appropriate box(es) or selctions. * fields are required.</strong></p>
                              <p class="text-muted text-center">
                                You must provide your address information on the fields provided. Once you fill all the required feilds hit the Continue button.
                              </p>
                              <hr>
                            </div>
                            <!-- /.card-body -->
                          </div>
                        </div>
                        <div class="col-12 col-md-9">
                          <div class="card card-outline card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Admission Information</strong>
                              </h3>
                            </div>
                            <div class="card-body" style="min-height: 313px !important; ">
                              <%= render 'admission', f: f%>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div id="address" class="content tab">
                      <div class="row">
                        <div class="col-12 col-md-3">
                          <div class="card card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Instruction</strong>
                              </h3>
                            </div>
                            <!-- /.card-header -->
                            <div class="card-body">
                              <p  class="text-center"><strong>Fill in the space(s) or Select the appropriate box(es) or selctions. * fields are required.</strong></p>
                              <p class="text-muted text-center">
                                You must provide your address information on the fields provided. Once you fill all the required feilds hit the Continue button.
                              </p>
                              <hr>
                            </div>
                            <!-- /.card-body -->
                          </div>
                        </div>
                        <div class="col-12 col-md-9">
                          <div class="card card-outline card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Contact Address</strong>
                              </h3>
                            </div>
                            <div class="card-body">
                              <%= render 'address', f: f%>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div id="emergency" class="content tab">
                      <div class="row">
                        <div class="col-12 col-md-3">
                          <div class="card card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Instruction</strong>
                              </h3>
                            </div>
                            <!-- /.card-header -->
                            <div class="card-body">
                              <p  class="text-center"><strong>Fill in the space(s) or Select the appropriate box(es) or selctions. * fields are required.</strong></p>
                              <p class="text-muted text-center">
                                You must provide your address information on the fields provided. Once you fill all the required feilds hit the Continue button.
                              </p>
                              <hr>
                            </div>
                            <!-- /.card-body -->
                          </div>
                        </div>
                        <div class="col-12 col-md-9">
                          <div class="card card-outline card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Emergency Contact Person Information</strong>
                              </h3>
                            </div>
                            <div class="card-body">
                              <%= render 'emergency', f: f%>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div id="school" class="content tab">
                      <div class="row">
                        <div class="col-12 col-md-3">
                          <div class="card card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Instruction</strong>
                              </h3>
                            </div>
                            <!-- /.card-header -->
                            <div class="card-body">
                              <p  class="text-center"><strong>Fill in the space(s) or Select the appropriate box(es) or selctions. * fields are required.</strong></p>
                              <p class="text-muted text-center">
                                You must provide your address information on the fields provided. Once you fill all the required feilds hit the Continue button.
                              </p>
                              <hr>
                            </div>
                            <!-- /.card-body -->
                          </div>
                        </div>
                        <div class="col-12 col-md-9">
                          <div class="card card-outline card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>High School Information</strong>
                              </h3>
                            </div>
                            <div class="card-body">
                              <%= render 'school', f: f %>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div id="scan" class="content tab">
                      <div class="row">
                        <div class="col-12 col-md-3">
                          <div class="card card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Instruction</strong>
                              </h3>
                            </div>
                            <!-- /.card-header -->
                            <div class="card-body">
                              <p  class="text-center"><strong>Fill in the space(s) or Select the appropriate box(es) or selctions. * fields are required.</strong></p>
                              <p class="text-muted text-center">
                                Upload a scanned copy of all your relevant academic documents. You must include your <strong>grade 8,10,and 12 certifaces</strong>;your <strong>grade 9,10,11,and 12 transcripts</strong>,COC, TVET/Diploma certificate(if any). If you are applying for Postgraduate program,you must upload your <strong>Degree</strong> certificate.
                              </p>
                              <p class="text-muted text-center">file type allowed are pdf and image files</p>
                              <hr>
                            </div>
                            <!-- /.card-body -->
                          </div>
                        </div>
                        <div class="col-12 col-md-9">
                          <div class="card card-outline card-primary">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Scan Document Uploading</strong>
                              </h3>
                            </div>
                            <div class="card-body">
                              <%= render 'document', f: f%>
                                <div class="mr-2" style="float:right; margin-top: 5px;">
                                <button type="button" class="submit" style="background-color: blue; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Submit</button>
                                </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <%= f.input :created_by, as: :hidden, :input_html => { :value => "self"}%>
                  <%=f.input :year, as: :hidden, :input_html => { :value => 1}%>
                  <%=f.input :semester, as: :hidden, :input_html => { :value => 1}%>
                </div>
              </div>
              <div class="card-footer fix clearfix">
  <div style="overflow:auto;">
  <div style="float:left; text-align:center; margin-top: 5px;">
  <span class="step" data-step="0" style="display: inline-block; padding: 5px 10px; margin: 0 5px; background-color: green; color: white; border: none; border-radius: 5px; cursor: pointer; text-align: center; text-decoration: none; font-size: 18px; transition: background-color 0.3s ease;">1</span>
  <span class="step" data-step="1" style="display: inline-block; padding: 5px 10px; margin: 0 5px; background-color: green; color: white; border: none; border-radius: 5px; cursor: pointer; text-align: center; text-decoration: none; font-size: 18px; transition: background-color 0.3s ease;">2</span>
  <span class="step" data-step="2" style="display: inline-block; padding: 5px 10px; margin: 0 5px; background-color: green; color: white; border: none; border-radius: 5px; cursor: pointer; text-align: center; text-decoration: none; font-size: 18px; transition: background-color 0.3s ease;">3</span>
  <span class="step" data-step="3" style="display: inline-block; padding: 5px 10px; margin: 0 5px; background-color: green; color: white; border: none; border-radius: 5px; cursor: pointer; text-align: center; text-decoration: none; font-size: 18px; transition: background-color 0.3s ease;">4</span>
  <span class="step" data-step="4" style="display: inline-block; padding: 5px 10px; margin: 0 5px; background-color: green; color: white; border: none; border-radius: 5px; cursor: pointer; text-align: center; text-decoration: none; font-size: 18px; transition: background-color 0.3s ease;">5</span>
  <span class="step" data-step="5" style="display: inline-block; padding: 5px 10px; margin: 0 5px; background-color: green; color: white; border: none; border-radius: 5px; cursor: pointer; text-align: center; text-decoration: none; font-size: 18px; transition: background-color 0.3s ease;">6</span>
</div>

   
  </div>
</div>

            <%end%>
            <!-- /.card-body -->
          </div>
          <!-- /.card -->
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(document).on('turbolinks:load', function() {

    $.fn.multiStepForm = function(args) {
      if (!args || typeof args !== 'object' || $.isArray(args)) {
        throw "Invalid argument: args should be an object";
      }

      var form = this;
      var tabs = form.find('.tab');
      var steps = form.find('.step');

      function curIndex() {
        return tabs.index(tabs.filter('.current'));
      }

      function fixStepIndicator(n) {
        steps.each(function(i, e) {
          $(e).toggleClass('active', i === n);
        });
      }

      form.navigateTo = function(i) {
        tabs.removeClass('current').eq(i).addClass('current');
        fixStepIndicator(i);
        return form;
      };

      steps.click(function() {
        var stepIndex = $(this).data('step');
        form.navigateTo(stepIndex);
      });

      form.find('.submit').on('click', function(e) {
        if (typeof args.beforeSubmit === 'function') {
          args.beforeSubmit(form, this);
        }
        if (args.submit !== false) {
          form.submit();
        }
        return form;
      });

      if (typeof args.defaultStep === 'number') {
        form.navigateTo(args.defaultStep);
      } else {
        form.navigateTo(0);
      }

      return form;
    };

    $("#new_student").multiStepForm({
      beforeSubmit: function(form, submit) {
        console.log("called before submitting the form");
        console.log(form);
        console.log(submit);
      }
    });
  });
</script>


<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/jquery.validate.min.js"></script>
<script type="text/javascript">
  $(document).on('turbolinks:load', function(){
   
    var a = new Date().getFullYear() - 18
    var b = a + "-15"
    flatpickr('.birthdate',{
      maxDate: b
    });

    $.validator.addMethod('username', function(value, element, param) {
      var nameRegex = /^[a-zA-Z0-9]+$/;
      return value.match(nameRegex);
    }, 'Only a-z, A-Z, 0-9 characters are allowed');

    $.validator.addMethod('password', function(value, element, param) {
      var nameRegex = /^(?=.*[a-z])(?=.*[A-Z])/;
      return value.match(nameRegex);
    }, 'Must be between 5 to 20 characters which contain at least one lowercase letter, one uppercase letter, one numeric digit, and one special character');

    var val = {
        rules: {
          'student[photo]': {
            required: true,
          },
          'student[date_of_birth]': {
            required: true,
          },
          'student[first_name]': {
            required: true,
          },
          'student[last_name]': {
            required: true,
          },
          'student[middle_name]': {
            required: true,
          },
          'student[email]': {
            required: true,
            email: true,
          },
          'student[phone]': {
            required: true,
            minlength: 10,
            maxlength: 10,
            digits: true,
          },
          'student[date]': {
            required: true,
            minlength: 2,
            maxlength: 2,
            digits: true,
          },
          'student[month]': {
            required: true,
            minlength: 2,
            maxlength: 2,
            digits: true,
          },
          'student[year]': {
            required: true,
            minlength: 4,
            maxlength: 4,
            digits: true,
          },
          'username': {
            required: true,
            minlength: 4,
            maxlength: 16,
          },
          'password': {
            required: true,
            minlength: 8,
          }
        },
        messages: {
          'student[photo]': "Photo is required",
          'student[date_of_birth]': "Date of birth is required",
          'student[first_name]': "First name is required",
          'student[last_name]': "Last name is required",
          'student[middle_name]': "Middle name is required",
          'student[email]': {
            required: "Email is required",
            email: "Please enter a valid e-mail",
          },
          'student[phone]': {
            required: "Phone number is required",
            minlength: "Please enter 10 digit mobile number",
            maxlength: "Please enter 10 digit mobile number",
            digits: "Only numbers are allowed in this field",
          },
          'student[date]': {
            required: "Date is required",
            minlength: "Date should be a 2 digit number, e.g., 01 or 20",
            maxlength: "Date should be a 2 digit number, e.g., 01 or 20",
            digits: "Date should be a number",
          },
          'student[month]': {
            required: "Month is required",
            minlength: "Month should be a 2 digit number, e.g., 01 or 12",
            maxlength: "Month should be a 2 digit number, e.g., 01 or 12",
            digits: "Only numbers are allowed in this field",
          },
          'student[year]': {
            required: "Year is required",
            minlength: "Year should be a 4 digit number, e.g., 2018 or 1990",
            maxlength: "Year should be a 4 digit number, e.g., 2018 or 1990",
            digits: "Only numbers are allowed in this field",
          },
          'username': {
            required: "Username is required",
            minlength: "Username should be minimum 4 characters",
            maxlength: "Username should be maximum 16 characters",
          },
          'password': {
            required: "Password is required",
            minlength: "Password should be minimum 8 characters",
          }
        }
    };

    $("#new_student").multiStepForm({
      beforeSubmit: function(form, submit) {
        form.validate(val);
        if (form.valid()) {
          form.submit();
        }
      },
      validations: val,
    }).navigateTo(0);
  });

  document.addEventListener('DOMContentLoaded', function() {
    var currentTab = 0; // Start at the first tab
    showTab(currentTab); // Display the current tab
    
    function showTab(n) {
      // Get all tab elements
      var x = document.getElementsByClassName("tab");
      x[n].style.display = "block";
      
      // Hide or show the submit button based on the step
      if (n == 5) { // If this is the last step (6th step, zero-indexed)
        document.querySelector("input[type='submit']").style.display = "inline-block";
      } else {
        document.querySelector("input[type='submit']").style.display = "none";
      }

      if (n == (x.length - 1)) {
        document.querySelector(".next").style.display = "none";
        document.querySelector("input[type=submit]").style.display = "inline";
      } else {
        document.querySelector(".next").style.display = "inline";
        document.querySelector("input[type=submit]").style.display = "none";
      }
    }
    // Add more navigation handling logic here for previous/next buttons
  });

  document.addEventListener('DOMContentLoaded', function() {
    const steps = document.querySelectorAll('.step');
    let currentStep = 0;

    function updateStepClass() {
        document.body.classList.toggle('step-active-5', currentStep === 5);
    }

    steps.forEach((step, index) => {
        step.addEventListener('click', function() {
            currentStep = index;
            updateStepClass();
        });
    });

    updateStepClass(); // Initial check
});

</script>

